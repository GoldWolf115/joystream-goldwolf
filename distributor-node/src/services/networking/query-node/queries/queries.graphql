fragment DataObjectDetails on StorageDataObject {
  id
  size
  ipfsHash
  isAccepted
  storageBag {
    storedBy {
      id
      operatorMetadata {
        nodeEndpoint
      }
      operatorStatus {
        __typename
      }
    }
    distributedBy {
      id
    }
  }
}

query getDataObjectDetails($id: ID!) {
  storageDataObjectByUniqueInput(where: { id: $id }) {
    ...DataObjectDetails
  }
}

fragment DistirubtionBucketsWithObjects on DistributionBucket {
  id
  distributedBags {
    objects {
      id
      size
      ipfsHash
    }
  }
}

query getDistributionBucketsWithObjects($ids: [ID!]) {
  distributionBuckets(where: { id_in: $ids }) {
    ...DistirubtionBucketsWithObjects
  }
}

fragment StorageBucketOperatorFields on StorageBucket {
  id
  operatorMetadata {
    nodeEndpoint
  }
}

query getActiveStorageBucketOperatorsData {
  storageBuckets(
    where: {
      operatorStatus_json: { isTypeOf_eq: "StorageBucketOperatorStatusActive" },
      operatorMetadata: { nodeEndpoint_contains: "http" }
    },
    limit: 9999
  ) {
    ...StorageBucketOperatorFields
  }
}
